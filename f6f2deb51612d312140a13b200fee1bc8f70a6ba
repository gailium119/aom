{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "8c7551c3_b8857438",
        "filename": "av1/encoder/temporal_filter.c",
        "patchSetId": 3
      },
      "lineNbr": 247,
      "author": {
        "id": 9545
      },
      "writtenOn": "2024-11-23T02:00:52Z",
      "side": 1,
      "message": "Yunqing, when running the AV1/MotionVectorTestLarge.OverallTest/0 test, `cpi-\u003emv_search_params.find_fractional_mv_step` is equal to `av1_return_max_sub_pixel_mv` here, so we will call `av1_return_max_sub_pixel_mv()`.\n\nBut `av1_return_max_sub_pixel_mv()` does not set its `sse1` output parameter:\n\n```\nint av1_return_max_sub_pixel_mv(MACROBLOCKD *xd, const AV1_COMMON *const cm,\n                                const SUBPEL_MOTION_SEARCH_PARAMS *ms_params,\n                                MV start_mv,\n                                const FULLPEL_MV_STATS *start_mv_stats,\n                                MV *bestmv, int *distortion, unsigned int *sse1,\n                                int_mv *last_mv_search_list) {\n  (void)xd;\n  (void)cm;\n  (void)start_mv;\n  (void)start_mv_stats;\n  (void)sse1;\n  (void)distortion;\n  (void)last_mv_search_list;\n\n  const int allow_hp \u003d ms_params-\u003eallow_hp;\n  const SubpelMvLimits *mv_limits \u003d \u0026ms_params-\u003emv_limits;\n\n  bestmv-\u003erow \u003d mv_limits-\u003erow_max;\n  bestmv-\u003ecol \u003d mv_limits-\u003ecol_max;\n\n  unsigned int besterr \u003d 0;\n\n  // In the sub-pel motion search, if hp is not used, then the last bit of mv\n  // has to be 0.\n  lower_mv_precision(bestmv, allow_hp, 0);\n  return besterr;                      \n}\n```\n\nSo the local variable `sse` will still be uninitialized after this call.",
      "revId": "f6f2deb51612d312140a13b200fee1bc8f70a6ba",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e879f418_affe152d",
        "filename": "av1/encoder/temporal_filter.c",
        "patchSetId": 3
      },
      "lineNbr": 247,
      "author": {
        "id": 9545
      },
      "writtenOn": "2024-11-23T02:08:48Z",
      "side": 1,
      "message": "`av1_return_min_sub_pixel_mv()` also does not set its `sse1` output parameter.",
      "parentUuid": "8c7551c3_b8857438",
      "revId": "f6f2deb51612d312140a13b200fee1bc8f70a6ba",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ec63bb81_2939aa8b",
        "filename": "av1/encoder/temporal_filter.c",
        "patchSetId": 3
      },
      "lineNbr": 251,
      "author": {
        "id": 9545
      },
      "writtenOn": "2024-11-23T02:00:52Z",
      "side": 1,
      "message": "We use uninitialized value of `sse` here. Both valgrind and msan reported this error.\n\n`av1_return_max_sub_pixel_mv()` needs to set its `sse1` output parameter to some reasonble value.",
      "revId": "f6f2deb51612d312140a13b200fee1bc8f70a6ba",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}